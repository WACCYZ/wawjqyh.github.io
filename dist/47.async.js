(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[47],{XD5A:function(s,a){s.exports='<h1 id="proxy">Proxy</h1>\n<h2 id="\u6982\u8ff0">\u6982\u8ff0</h2>\n<p>Proxy \u7528\u4e8e\u4fee\u6539\u67d0\u4e9b\u64cd\u4f5c\u7684\u9ed8\u8ba4\u884c\u4e3a\uff0c\u7b49\u540c\u4e8e\u5728\u8bed\u8a00\u5c42\u9762\u505a\u51fa\u4fee\u6539\uff0c\u6240\u4ee5\u5c5e\u4e8e\u4e00\u79cd\u201c\u5143\u7f16\u7a0b\u201d\uff08meta programming\uff09\uff0c\u5373\u5bf9\u7f16\u7a0b\u8bed\u8a00\u8fdb\u884c\u7f16\u7a0b\u3002</p>\n<p>Proxy \u53ef\u4ee5\u7406\u89e3\u6210\uff0c\u5728\u76ee\u6807\u5bf9\u8c61\u4e4b\u524d\u67b6\u8bbe\u4e00\u5c42\u201c\u62e6\u622a\u201d\uff0c\u5916\u754c\u5bf9\u8be5\u5bf9\u8c61\u7684\u8bbf\u95ee\uff0c\u90fd\u5fc5\u987b\u5148\u901a\u8fc7\u8fd9\u5c42\u62e6\u622a\uff0c\u56e0\u6b64\u63d0\u4f9b\u4e86\u4e00\u79cd\u673a\u5236\uff0c\u53ef\u4ee5\u5bf9\u5916\u754c\u7684\u8bbf\u95ee\u8fdb\u884c\u8fc7\u6ee4\u548c\u6539\u5199\u3002Proxy \u8fd9\u4e2a\u8bcd\u7684\u539f\u610f\u662f\u4ee3\u7406\uff0c\u7528\u5728\u8fd9\u91cc\u8868\u793a\u7531\u5b83\u6765\u201c\u4ee3\u7406\u201d\u67d0\u4e9b\u64cd\u4f5c\uff0c\u53ef\u4ee5\u8bd1\u4e3a\u201c\u4ee3\u7406\u5668\u201d\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">var</span> obj = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>({}, {\n  <span class="hljs-attr">get</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">target, key, receiver</span>) </span>{\n    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`getting <span class="hljs-subst">${key}</span>!`</span>);\n    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Reflect</span>.get(target, key, receiver);\n  },\n  <span class="hljs-attr">set</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">target, key, value, receiver</span>) </span>{\n    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`setting <span class="hljs-subst">${key}</span>!`</span>);\n    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Reflect</span>.set(target, key, value, receiver);\n  }\n});</code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u5bf9\u4e00\u4e2a\u7a7a\u5bf9\u8c61\u67b6\u8bbe\u4e86\u4e00\u5c42\u62e6\u622a\uff0c\u91cd\u5b9a\u4e49\u4e86\u5c5e\u6027\u7684\u8bfb\u53d6\uff08<code>get</code>\uff09\u548c\u8bbe\u7f6e\uff08<code>set</code>\uff09\u884c\u4e3a\u3002\u8fd9\u91cc\u6682\u65f6\u5148\u4e0d\u89e3\u91ca\u5177\u4f53\u7684\u8bed\u6cd5\uff0c\u53ea\u770b\u8fd0\u884c\u7ed3\u679c\u3002\u5bf9\u8bbe\u7f6e\u4e86\u62e6\u622a\u884c\u4e3a\u7684\u5bf9\u8c61<code>obj</code>\uff0c\u53bb\u8bfb\u5199\u5b83\u7684\u5c5e\u6027\uff0c\u5c31\u4f1a\u5f97\u5230\u4e0b\u9762\u7684\u7ed3\u679c\u3002</p>\n<pre><code class="language-javascript">obj<span class="hljs-selector-class">.count</span> = <span class="hljs-number">1</span>\n<span class="hljs-comment">//  setting count!</span>\n++obj<span class="hljs-selector-class">.count</span>\n<span class="hljs-comment">//  getting count!</span>\n<span class="hljs-comment">//  setting count!</span>\n<span class="hljs-comment">//  2</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u8bf4\u660e\uff0cProxy \u5b9e\u9645\u4e0a\u91cd\u8f7d\uff08overload\uff09\u4e86\u70b9\u8fd0\u7b97\u7b26\uff0c\u5373\u7528\u81ea\u5df1\u7684\u5b9a\u4e49\u8986\u76d6\u4e86\u8bed\u8a00\u7684\u539f\u59cb\u5b9a\u4e49\u3002</p>\n<p>ES6 \u539f\u751f\u63d0\u4f9b Proxy \u6784\u9020\u51fd\u6570\uff0c\u7528\u6765\u751f\u6210 Proxy \u5b9e\u4f8b\u3002</p>\n<pre><code class="language-javascript">var<span class="hljs-built_in"> proxy </span>= new Proxy(target, handler);</code></pre>\n<p>Proxy \u5bf9\u8c61\u7684\u6240\u6709\u7528\u6cd5\uff0c\u90fd\u662f\u4e0a\u9762\u8fd9\u79cd\u5f62\u5f0f\uff0c\u4e0d\u540c\u7684\u53ea\u662f<code>handler</code>\u53c2\u6570\u7684\u5199\u6cd5\u3002\u5176\u4e2d\uff0c<code>new Proxy()</code>\u8868\u793a\u751f\u6210\u4e00\u4e2a<code>Proxy</code>\u5b9e\u4f8b\uff0c<code>target</code>\u53c2\u6570\u8868\u793a\u6240\u8981\u62e6\u622a\u7684\u76ee\u6807\u5bf9\u8c61\uff0c<code>handler</code>\u53c2\u6570\u4e5f\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u7528\u6765\u5b9a\u5236\u62e6\u622a\u884c\u4e3a\u3002</p>\n<p>\u4e0b\u9762\u662f\u53e6\u4e00\u4e2a\u62e6\u622a\u8bfb\u53d6\u5c5e\u6027\u884c\u4e3a\u7684\u4f8b\u5b50\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">var</span> proxy = <span class="hljs-keyword">new</span> Proxy({}, {\n  <span class="hljs-keyword">get</span>: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(target, property)</span> </span>{\n    <span class="hljs-keyword">return</span> <span class="hljs-number">35</span>;\n  }\n});\n\nproxy.time <span class="hljs-comment">// 35</span>\nproxy.name <span class="hljs-comment">// 35</span>\nproxy.title <span class="hljs-comment">// 35</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u4f5c\u4e3a\u6784\u9020\u51fd\u6570\uff0c<code>Proxy</code>\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570\u3002\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u6240\u8981\u4ee3\u7406\u7684\u76ee\u6807\u5bf9\u8c61\uff08\u4e0a\u4f8b\u662f\u4e00\u4e2a\u7a7a\u5bf9\u8c61\uff09\uff0c\u5373\u5982\u679c\u6ca1\u6709<code>Proxy</code>\u7684\u4ecb\u5165\uff0c\u64cd\u4f5c\u539f\u6765\u8981\u8bbf\u95ee\u7684\u5c31\u662f\u8fd9\u4e2a\u5bf9\u8c61\uff1b\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u4e00\u4e2a\u914d\u7f6e\u5bf9\u8c61\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u88ab\u4ee3\u7406\u7684\u64cd\u4f5c\uff0c\u9700\u8981\u63d0\u4f9b\u4e00\u4e2a\u5bf9\u5e94\u7684\u5904\u7406\u51fd\u6570\uff0c\u8be5\u51fd\u6570\u5c06\u62e6\u622a\u5bf9\u5e94\u7684\u64cd\u4f5c\u3002\u6bd4\u5982\uff0c\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u914d\u7f6e\u5bf9\u8c61\u6709\u4e00\u4e2a<code>get</code>\u65b9\u6cd5\uff0c\u7528\u6765\u62e6\u622a\u5bf9\u76ee\u6807\u5bf9\u8c61\u5c5e\u6027\u7684\u8bbf\u95ee\u8bf7\u6c42\u3002<code>get</code>\u65b9\u6cd5\u7684\u4e24\u4e2a\u53c2\u6570\u5206\u522b\u662f\u76ee\u6807\u5bf9\u8c61\u548c\u6240\u8981\u8bbf\u95ee\u7684\u5c5e\u6027\u3002\u53ef\u4ee5\u770b\u5230\uff0c\u7531\u4e8e\u62e6\u622a\u51fd\u6570\u603b\u662f\u8fd4\u56de<code>35</code>\uff0c\u6240\u4ee5\u8bbf\u95ee\u4efb\u4f55\u5c5e\u6027\u90fd\u5f97\u5230<code>35</code>\u3002</p>\n<p>\u6ce8\u610f\uff0c\u8981\u4f7f\u5f97<code>Proxy</code>\u8d77\u4f5c\u7528\uff0c\u5fc5\u987b\u9488\u5bf9<code>Proxy</code>\u5b9e\u4f8b\uff08\u4e0a\u4f8b\u662f<code>proxy</code>\u5bf9\u8c61\uff09\u8fdb\u884c\u64cd\u4f5c\uff0c\u800c\u4e0d\u662f\u9488\u5bf9\u76ee\u6807\u5bf9\u8c61\uff08\u4e0a\u4f8b\u662f\u7a7a\u5bf9\u8c61\uff09\u8fdb\u884c\u64cd\u4f5c\u3002</p>\n<p>\u5982\u679c<code>handler</code>\u6ca1\u6709\u8bbe\u7f6e\u4efb\u4f55\u62e6\u622a\uff0c\u90a3\u5c31\u7b49\u540c\u4e8e\u76f4\u63a5\u901a\u5411\u539f\u5bf9\u8c61\u3002</p>\n<pre><code class="language-javascript">var <span class="hljs-keyword">target</span> = {};\nvar <span class="hljs-keyword">handler</span> = {};\nvar proxy = <span class="hljs-keyword">new</span> Proxy(<span class="hljs-keyword">target</span>, <span class="hljs-keyword">handler</span>);\nproxy.a = <span class="hljs-string">\'b\'</span>;\n<span class="hljs-keyword">target</span>.a <span class="hljs-comment">// "b"</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>handler</code>\u662f\u4e00\u4e2a\u7a7a\u5bf9\u8c61\uff0c\u6ca1\u6709\u4efb\u4f55\u62e6\u622a\u6548\u679c\uff0c\u8bbf\u95ee<code>proxy</code>\u5c31\u7b49\u540c\u4e8e\u8bbf\u95ee<code>target</code>\u3002</p>\n<p>\u4e00\u4e2a\u6280\u5de7\u662f\u5c06 Proxy \u5bf9\u8c61\uff0c\u8bbe\u7f6e\u5230<code>object.proxy</code>\u5c5e\u6027\uff0c\u4ece\u800c\u53ef\u4ee5\u5728<code>object</code>\u5bf9\u8c61\u4e0a\u8c03\u7528\u3002</p>\n<pre><code class="language-javascript">var object = { proxy: <span class="hljs-keyword">new</span> <span class="hljs-constructor">Proxy(<span class="hljs-params">target</span>, <span class="hljs-params">handler</span>)</span> };</code></pre>\n<p>Proxy \u5b9e\u4f8b\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u5176\u4ed6\u5bf9\u8c61\u7684\u539f\u578b\u5bf9\u8c61\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">var</span> proxy = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>({}, {\n  <span class="hljs-attr">get</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">target, property</span>) </span>{\n    <span class="hljs-keyword">return</span> <span class="hljs-number">35</span>;\n  }\n});\n\n<span class="hljs-keyword">let</span> obj = <span class="hljs-built_in">Object</span>.create(proxy);\nobj.time <span class="hljs-comment">// 35</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>proxy</code>\u5bf9\u8c61\u662f<code>obj</code>\u5bf9\u8c61\u7684\u539f\u578b\uff0c<code>obj</code>\u5bf9\u8c61\u672c\u8eab\u5e76\u6ca1\u6709<code>time</code>\u5c5e\u6027\uff0c\u6240\u4ee5\u6839\u636e\u539f\u578b\u94fe\uff0c\u4f1a\u5728<code>proxy</code>\u5bf9\u8c61\u4e0a\u8bfb\u53d6\u8be5\u5c5e\u6027\uff0c\u5bfc\u81f4\u88ab\u62e6\u622a\u3002</p>\n<p>\u540c\u4e00\u4e2a\u62e6\u622a\u5668\u51fd\u6570\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u62e6\u622a\u591a\u4e2a\u64cd\u4f5c\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">var</span> handler = {\n  <span class="hljs-attr">get</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">target, name</span>) </span>{\n    <span class="hljs-keyword">if</span> (name === <span class="hljs-string">\'prototype\'</span>) {\n      <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.prototype;\n    }\n    <span class="hljs-keyword">return</span> <span class="hljs-string">\'Hello, \'</span> + name;\n  },\n\n  <span class="hljs-attr">apply</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">target, thisBinding, args</span>) </span>{\n    <span class="hljs-keyword">return</span> args[<span class="hljs-number">0</span>];\n  },\n\n  <span class="hljs-attr">construct</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">target, args</span>) </span>{\n    <span class="hljs-keyword">return</span> {<span class="hljs-attr">value</span>: args[<span class="hljs-number">1</span>]};\n  }\n};\n\n<span class="hljs-keyword">var</span> fproxy = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">x, y</span>) </span>{\n  <span class="hljs-keyword">return</span> x + y;\n}, handler);\n\nfproxy(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>) <span class="hljs-comment">// 1</span>\n<span class="hljs-keyword">new</span> fproxy(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>) <span class="hljs-comment">// {value: 2}</span>\nfproxy.prototype === <span class="hljs-built_in">Object</span>.prototype <span class="hljs-comment">// true</span>\nfproxy.foo === <span class="hljs-string">"Hello, foo"</span> <span class="hljs-comment">// true</span></code></pre>\n<p>\u5bf9\u4e8e\u53ef\u4ee5\u8bbe\u7f6e\u3001\u4f46\u6ca1\u6709\u8bbe\u7f6e\u62e6\u622a\u7684\u64cd\u4f5c\uff0c\u5219\u76f4\u63a5\u843d\u5728\u76ee\u6807\u5bf9\u8c61\u4e0a\uff0c\u6309\u7167\u539f\u5148\u7684\u65b9\u5f0f\u4ea7\u751f\u7ed3\u679c\u3002</p>\n<p>\u4e0b\u9762\u662f Proxy \u652f\u6301\u7684\u62e6\u622a\u64cd\u4f5c\u4e00\u89c8\uff0c\u4e00\u5171 13 \u79cd\u3002</p>\n<ul>\n<li><strong>get(target, propKey, receiver)</strong>\uff1a\u62e6\u622a\u5bf9\u8c61\u5c5e\u6027\u7684\u8bfb\u53d6\uff0c\u6bd4\u5982<code>proxy.foo</code>\u548c<code>proxy[&#39;foo&#39;]</code>\u3002</li>\n<li><strong>set(target, propKey, value, receiver)</strong>\uff1a\u62e6\u622a\u5bf9\u8c61\u5c5e\u6027\u7684\u8bbe\u7f6e\uff0c\u6bd4\u5982<code>proxy.foo = v</code>\u6216<code>proxy[&#39;foo&#39;] = v</code>\uff0c\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u503c\u3002</li>\n<li><strong>has(target, propKey)</strong>\uff1a\u62e6\u622a<code>propKey in proxy</code>\u7684\u64cd\u4f5c\uff0c\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u503c\u3002</li>\n<li><strong>deleteProperty(target, propKey)</strong>\uff1a\u62e6\u622a<code>delete proxy[propKey]</code>\u7684\u64cd\u4f5c\uff0c\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u503c\u3002</li>\n<li><strong>ownKeys(target)</strong>\uff1a\u62e6\u622a<code>Object.getOwnPropertyNames(proxy)</code>\u3001<code>Object.getOwnPropertySymbols(proxy)</code>\u3001<code>Object.keys(proxy)</code>\uff0c\u8fd4\u56de\u4e00\u4e2a\u6570\u7ec4\u3002\u8be5\u65b9\u6cd5\u8fd4\u56de\u76ee\u6807\u5bf9\u8c61\u6240\u6709\u81ea\u8eab\u7684\u5c5e\u6027\u7684\u5c5e\u6027\u540d\uff0c\u800c<code>Object.keys()</code>\u7684\u8fd4\u56de\u7ed3\u679c\u4ec5\u5305\u62ec\u76ee\u6807\u5bf9\u8c61\u81ea\u8eab\u7684\u53ef\u904d\u5386\u5c5e\u6027\u3002</li>\n<li><strong>getOwnPropertyDescriptor(target, propKey)</strong>\uff1a\u62e6\u622a<code>Object.getOwnPropertyDescriptor(proxy, propKey)</code>\uff0c\u8fd4\u56de\u5c5e\u6027\u7684\u63cf\u8ff0\u5bf9\u8c61\u3002</li>\n<li><strong>defineProperty(target, propKey, propDesc)</strong>\uff1a\u62e6\u622a<code>Object.defineProperty(proxy, propKey, propDesc\uff09</code>\u3001<code>Object.defineProperties(proxy, propDescs)</code>\uff0c\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u503c\u3002</li>\n<li><strong>preventExtensions(target)</strong>\uff1a\u62e6\u622a<code>Object.preventExtensions(proxy)</code>\uff0c\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u503c\u3002</li>\n<li><strong>getPrototypeOf(target)</strong>\uff1a\u62e6\u622a<code>Object.getPrototypeOf(proxy)</code>\uff0c\u8fd4\u56de\u4e00\u4e2a\u5bf9\u8c61\u3002</li>\n<li><strong>isExtensible(target)</strong>\uff1a\u62e6\u622a<code>Object.isExtensible(proxy)</code>\uff0c\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u503c\u3002</li>\n<li><strong>setPrototypeOf(target, proto)</strong>\uff1a\u62e6\u622a<code>Object.setPrototypeOf(proxy, proto)</code>\uff0c\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u503c\u3002\u5982\u679c\u76ee\u6807\u5bf9\u8c61\u662f\u51fd\u6570\uff0c\u90a3\u4e48\u8fd8\u6709\u4e24\u79cd\u989d\u5916\u64cd\u4f5c\u53ef\u4ee5\u62e6\u622a\u3002</li>\n<li><strong>apply(target, object, args)</strong>\uff1a\u62e6\u622a Proxy \u5b9e\u4f8b\u4f5c\u4e3a\u51fd\u6570\u8c03\u7528\u7684\u64cd\u4f5c\uff0c\u6bd4\u5982<code>proxy(...args)</code>\u3001<code>proxy.call(object, ...args)</code>\u3001<code>proxy.apply(...)</code>\u3002</li>\n<li><strong>construct(target, args)</strong>\uff1a\u62e6\u622a Proxy \u5b9e\u4f8b\u4f5c\u4e3a\u6784\u9020\u51fd\u6570\u8c03\u7528\u7684\u64cd\u4f5c\uff0c\u6bd4\u5982<code>new proxy(...args)</code>\u3002</li>\n</ul>\n<h2 id="proxy-\u5b9e\u4f8b\u7684\u65b9\u6cd5">Proxy \u5b9e\u4f8b\u7684\u65b9\u6cd5</h2>\n<p>\u4e0b\u9762\u662f\u4e0a\u9762\u8fd9\u4e9b\u62e6\u622a\u65b9\u6cd5\u7684\u8be6\u7ec6\u4ecb\u7ecd\u3002</p>\n<h3 id="get">get()</h3>\n<p><code>get</code>\u65b9\u6cd5\u7528\u4e8e\u62e6\u622a\u67d0\u4e2a\u5c5e\u6027\u7684\u8bfb\u53d6\u64cd\u4f5c\uff0c\u53ef\u4ee5\u63a5\u53d7\u4e09\u4e2a\u53c2\u6570\uff0c\u4f9d\u6b21\u4e3a\u76ee\u6807\u5bf9\u8c61\u3001\u5c5e\u6027\u540d\u548c proxy \u5b9e\u4f8b\u672c\u8eab\uff08\u5373<code>this</code>\u5173\u952e\u5b57\u6307\u5411\u7684\u90a3\u4e2a\u5bf9\u8c61\uff09\uff0c\u5176\u4e2d\u6700\u540e\u4e00\u4e2a\u53c2\u6570\u53ef\u9009\u3002</p>\n<p><code>get</code>\u65b9\u6cd5\u7684\u7528\u6cd5\uff0c\u4e0a\u6587\u5df2\u7ecf\u6709\u4e00\u4e2a\u4f8b\u5b50\uff0c\u4e0b\u9762\u662f\u53e6\u4e00\u4e2a\u62e6\u622a\u8bfb\u53d6\u64cd\u4f5c\u7684\u4f8b\u5b50\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">var</span> person = {\n  <span class="hljs-attribute">name</span>: <span class="hljs-string">"\u5f20\u4e09"</span>\n};\n\n<span class="hljs-keyword">var</span> proxy = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(person, {\n  <span class="hljs-attribute">get</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">target, property</span>) </span>{\n    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">property</span><span class="hljs-string"> in target) {</span>\n      <span class="hljs-keyword">return</span> target[<span class="hljs-keyword">property</span><span class="hljs-string">]</span>;\n    } <span class="hljs-title">else</span> {\n      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">ReferenceError</span>(<span class="hljs-string">"Property \\""</span> + <span class="hljs-keyword">property</span><span class="hljs-string"> + "\\" does not exist.")</span>;\n    }\n  }\n});\n\nproxy.name <span class="hljs-comment">// "\u5f20\u4e09"</span>\nproxy.age <span class="hljs-comment">// \u629b\u51fa\u4e00\u4e2a\u9519\u8bef</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u8868\u793a\uff0c\u5982\u679c\u8bbf\u95ee\u76ee\u6807\u5bf9\u8c61\u4e0d\u5b58\u5728\u7684\u5c5e\u6027\uff0c\u4f1a\u629b\u51fa\u4e00\u4e2a\u9519\u8bef\u3002\u5982\u679c\u6ca1\u6709\u8fd9\u4e2a\u62e6\u622a\u51fd\u6570\uff0c\u8bbf\u95ee\u4e0d\u5b58\u5728\u7684\u5c5e\u6027\uff0c\u53ea\u4f1a\u8fd4\u56de<code>undefined</code>\u3002</p>\n<p><code>get</code>\u65b9\u6cd5\u53ef\u4ee5\u7ee7\u627f\u3002</p>\n<pre><code class="language-javascript">let proto = new Proxy({}, {\n  get(target, propertyKey, receiver) {\n    console.log(\'GET \' + propertyKey);\n    return target<span class="hljs-string">[propertyKey]</span>;\n  }\n});\n\nlet obj = Object.create(proto);\nobj.foo // <span class="hljs-string">"<span class="hljs-keyword">GET</span> foo"</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u62e6\u622a\u64cd\u4f5c\u5b9a\u4e49\u5728<code>Prototype</code>\u5bf9\u8c61\u4e0a\u9762\uff0c\u6240\u4ee5\u5982\u679c\u8bfb\u53d6<code>obj</code>\u5bf9\u8c61\u7ee7\u627f\u7684\u5c5e\u6027\u65f6\uff0c\u62e6\u622a\u4f1a\u751f\u6548\u3002</p>\n<p>\u4e0b\u9762\u7684\u4f8b\u5b50\u4f7f\u7528<code>get</code>\u62e6\u622a\uff0c\u5b9e\u73b0\u6570\u7ec4\u8bfb\u53d6\u8d1f\u6570\u7684\u7d22\u5f15\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">function</span> create<span class="hljs-constructor">Array(<span class="hljs-operator">...</span><span class="hljs-params">elements</span>)</span> {\n  <span class="hljs-keyword">let</span> handler = {\n    get(target, propKey, receiver) {\n      <span class="hljs-keyword">let</span> index = <span class="hljs-constructor">Number(<span class="hljs-params">propKey</span>)</span>;\n      <span class="hljs-keyword">if</span> (index &lt; <span class="hljs-number">0</span>) {\n        propKey = <span class="hljs-constructor">String(<span class="hljs-params">target</span>.<span class="hljs-params">length</span> + <span class="hljs-params">index</span>)</span>;\n      }\n      return <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Reflect</span>.</span></span>get(target, propKey, receiver);\n    }\n  };\n\n  <span class="hljs-keyword">let</span> target = <span class="hljs-literal">[]</span>;\n  target.push(...elements);\n  return <span class="hljs-keyword">new</span> <span class="hljs-constructor">Proxy(<span class="hljs-params">target</span>, <span class="hljs-params">handler</span>)</span>;\n}\n\n<span class="hljs-keyword">let</span> arr = create<span class="hljs-constructor">Array(\'<span class="hljs-params">a</span>\', \'<span class="hljs-params">b</span>\', \'<span class="hljs-params">c</span>\')</span>;\narr<span class="hljs-literal">[-<span class="hljs-number">1</span>]</span> <span class="hljs-comment">// c</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u6570\u7ec4\u7684\u4f4d\u7f6e\u53c2\u6570\u662f<code>-1</code>\uff0c\u5c31\u4f1a\u8f93\u51fa\u6570\u7ec4\u7684\u5012\u6570\u6700\u540e\u4e00\u4e2a\u6210\u5458\u3002</p>\n<p>\u5229\u7528 Proxy\uff0c\u53ef\u4ee5\u5c06\u8bfb\u53d6\u5c5e\u6027\u7684\u64cd\u4f5c\uff08<code>get</code>\uff09\uff0c\u8f6c\u53d8\u4e3a\u6267\u884c\u67d0\u4e2a\u51fd\u6570\uff0c\u4ece\u800c\u5b9e\u73b0\u5c5e\u6027\u7684\u94fe\u5f0f\u64cd\u4f5c\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">var</span> pipe = (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{\n  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">value</span>) </span>{\n    <span class="hljs-keyword">var</span> funcStack = [];\n    <span class="hljs-keyword">var</span> oproxy = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>({} , {\n      <span class="hljs-attr">get</span> : <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">pipeObject, fnName</span>) </span>{\n        <span class="hljs-keyword">if</span> (fnName === <span class="hljs-string">\'get\'</span>) {\n          <span class="hljs-keyword">return</span> funcStack.reduce(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">val, fn</span>) </span>{\n            <span class="hljs-keyword">return</span> fn(val);\n          },value);\n        }\n        funcStack.push(<span class="hljs-built_in">window</span>[fnName]);\n        <span class="hljs-keyword">return</span> oproxy;\n      }\n    });\n\n    <span class="hljs-keyword">return</span> oproxy;\n  }\n}());\n\n<span class="hljs-keyword">var</span> double = <span class="hljs-function"><span class="hljs-params">n</span> =&gt;</span> n * <span class="hljs-number">2</span>;\n<span class="hljs-keyword">var</span> pow    = <span class="hljs-function"><span class="hljs-params">n</span> =&gt;</span> n * n;\n<span class="hljs-keyword">var</span> reverseInt = <span class="hljs-function"><span class="hljs-params">n</span> =&gt;</span> n.toString().split(<span class="hljs-string">""</span>).reverse().join(<span class="hljs-string">""</span>) | <span class="hljs-number">0</span>;\n\npipe(<span class="hljs-number">3</span>).double.pow.reverseInt.get; <span class="hljs-comment">// 63</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u8bbe\u7f6e Proxy \u4ee5\u540e\uff0c\u8fbe\u5230\u4e86\u5c06\u51fd\u6570\u540d\u94fe\u5f0f\u4f7f\u7528\u7684\u6548\u679c\u3002</p>\n<p>\u4e0b\u9762\u7684\u4f8b\u5b50\u5219\u662f\u5229\u7528<code>get</code>\u62e6\u622a\uff0c\u5b9e\u73b0\u4e00\u4e2a\u751f\u6210\u5404\u79cd DOM \u8282\u70b9\u7684\u901a\u7528\u51fd\u6570<code>dom</code>\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> dom = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>({}, {\n  get(target, <span class="hljs-keyword">property</span><span class="hljs-string">) {</span>\n    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">attrs = {}, ...children</span>) </span>{\n      <span class="hljs-keyword">const</span> el = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-keyword">property</span><span class="hljs-string">)</span>;\n      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> prop <span class="hljs-keyword">of</span> <span class="hljs-built_in">Object</span>.keys(attrs)) {\n        el.setAttribute(prop, attrs[prop]);\n      }\n      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> child <span class="hljs-keyword">of</span> children) {\n        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> child === <span class="hljs-string">\'string\'</span>) {\n          child = <span class="hljs-built_in">document</span>.createTextNode(child);\n        }\n        el.appendChild(child);\n      }\n      <span class="hljs-keyword">return</span> el;\n    }\n  }\n});\n\n<span class="hljs-keyword">const</span> el = dom.div({},\n  <span class="hljs-string">\'Hello, my name is \'</span>,\n  dom.a({<span class="hljs-attribute">href</span>: <span class="hljs-string">\'//example.com\'</span>}, <span class="hljs-string">\'Mark\'</span>),\n  <span class="hljs-string">\'. I like:\'</span>,\n  dom.ul({},\n    dom.li({}, <span class="hljs-string">\'The web\'</span>),\n    dom.li({}, <span class="hljs-string">\'Food\'</span>),\n    dom.li({}, <span class="hljs-string">\'\u2026actually that\\\'s it\'</span>)\n  )\n);\n\n<span class="hljs-built_in">document</span>.body.appendChild(el);</code></pre>\n<p>\u4e0b\u9762\u662f\u4e00\u4e2a<code>get</code>\u65b9\u6cd5\u7684\u7b2c\u4e09\u4e2a\u53c2\u6570\u7684\u4f8b\u5b50\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> proxy = <span class="hljs-keyword">new</span> Proxy({}, {\n  <span class="hljs-keyword">get</span>: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(target, property, receiver)</span> </span>{\n    <span class="hljs-keyword">return</span> receiver;\n  }\n});\nproxy.getReceiver === proxy <span class="hljs-comment">// true</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>get</code>\u65b9\u6cd5\u7684\u7b2c\u4e09\u4e2a\u53c2\u6570<code>receiver</code>\uff0c\u603b\u662f\u4e3a\u5f53\u524d\u7684 Proxy \u5b9e\u4f8b\u3002</p>\n<p>\u5982\u679c\u4e00\u4e2a\u5c5e\u6027\u4e0d\u53ef\u914d\u7f6e\uff08configurable\uff09\u548c\u4e0d\u53ef\u5199\uff08writable\uff09\uff0c\u5219\u8be5\u5c5e\u6027\u4e0d\u80fd\u88ab\u4ee3\u7406\uff0c\u901a\u8fc7 Proxy \u5bf9\u8c61\u8bbf\u95ee\u8be5\u5c5e\u6027\u4f1a\u62a5\u9519\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> <span class="hljs-keyword">target</span> = Object.defineProperties({}, {\n  foo: {\n    value: 123,\n    writable: <span class="hljs-keyword">false</span>,\n    configurable: <span class="hljs-keyword">false</span>\n  },\n});\n\n<span class="hljs-keyword">const</span> <span class="hljs-keyword">handler</span> = {\n  get(<span class="hljs-keyword">target</span>, propKey) {\n    <span class="hljs-keyword">return</span> <span class="hljs-string">\'abc\'</span>;\n  }\n};\n\n<span class="hljs-keyword">const</span> proxy = <span class="hljs-keyword">new</span> Proxy(<span class="hljs-keyword">target</span>, <span class="hljs-keyword">handler</span>);\n\nproxy.foo\n<span class="hljs-comment">// TypeError: Invariant check failed</span></code></pre>\n<h3 id="set">set()</h3>\n<p><code>set</code>\u65b9\u6cd5\u7528\u6765\u62e6\u622a\u67d0\u4e2a\u5c5e\u6027\u7684\u8d4b\u503c\u64cd\u4f5c\uff0c\u53ef\u4ee5\u63a5\u53d7\u56db\u4e2a\u53c2\u6570\uff0c\u4f9d\u6b21\u4e3a\u76ee\u6807\u5bf9\u8c61\u3001\u5c5e\u6027\u540d\u3001\u5c5e\u6027\u503c\u548c Proxy \u5b9e\u4f8b\u672c\u8eab\uff0c\u5176\u4e2d\u6700\u540e\u4e00\u4e2a\u53c2\u6570\u53ef\u9009\u3002</p>\n<p>\u5047\u5b9a<code>Person</code>\u5bf9\u8c61\u6709\u4e00\u4e2a<code>age</code>\u5c5e\u6027\uff0c\u8be5\u5c5e\u6027\u5e94\u8be5\u662f\u4e00\u4e2a\u4e0d\u5927\u4e8e 200 \u7684\u6574\u6570\uff0c\u90a3\u4e48\u53ef\u4ee5\u4f7f\u7528<code>Proxy</code>\u4fdd\u8bc1<code>age</code>\u7684\u5c5e\u6027\u503c\u7b26\u5408\u8981\u6c42\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">let</span> validator = {\n  set: <span class="hljs-keyword">function</span>(obj, prop, value) {\n    <span class="hljs-keyword">if</span> (prop<span class="hljs-operator"> === </span>\'age\') {\n      <span class="hljs-keyword">if</span> (!<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Number</span>.</span></span>is<span class="hljs-constructor">Integer(<span class="hljs-params">value</span>)</span>) {\n        throw <span class="hljs-keyword">new</span> <span class="hljs-constructor">TypeError(\'The <span class="hljs-params">age</span> <span class="hljs-params">is</span> <span class="hljs-params">not</span> <span class="hljs-params">an</span> <span class="hljs-params">integer</span>\')</span>;\n      }\n      <span class="hljs-keyword">if</span> (value &gt; <span class="hljs-number">200</span>) {\n        throw <span class="hljs-keyword">new</span> <span class="hljs-constructor">RangeError(\'The <span class="hljs-params">age</span> <span class="hljs-params">seems</span> <span class="hljs-params">invalid</span>\')</span>;\n      }\n    }\n\n    <span class="hljs-comment">// \u5bf9\u4e8eage\u4ee5\u5916\u7684\u5c5e\u6027\uff0c\u76f4\u63a5\u4fdd\u5b58</span>\n    obj<span class="hljs-literal">[<span class="hljs-identifier">prop</span>]</span> = value;\n  }\n};\n\n<span class="hljs-keyword">let</span> person = <span class="hljs-keyword">new</span> <span class="hljs-constructor">Proxy({}, <span class="hljs-params">validator</span>)</span>;\n\nperson.age = <span class="hljs-number">100</span>;\n\nperson.age <span class="hljs-comment">// 100</span>\nperson.age = \'young\' <span class="hljs-comment">// \u62a5\u9519</span>\nperson.age = <span class="hljs-number">300</span> <span class="hljs-comment">// \u62a5\u9519</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u7531\u4e8e\u8bbe\u7f6e\u4e86\u5b58\u503c\u51fd\u6570<code>set</code>\uff0c\u4efb\u4f55\u4e0d\u7b26\u5408\u8981\u6c42\u7684<code>age</code>\u5c5e\u6027\u8d4b\u503c\uff0c\u90fd\u4f1a\u629b\u51fa\u4e00\u4e2a\u9519\u8bef\uff0c\u8fd9\u662f\u6570\u636e\u9a8c\u8bc1\u7684\u4e00\u79cd\u5b9e\u73b0\u65b9\u6cd5\u3002\u5229\u7528<code>set</code>\u65b9\u6cd5\uff0c\u8fd8\u53ef\u4ee5\u6570\u636e\u7ed1\u5b9a\uff0c\u5373\u6bcf\u5f53\u5bf9\u8c61\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u4f1a\u81ea\u52a8\u66f4\u65b0 DOM\u3002</p>\n<p>\u6709\u65f6\uff0c\u6211\u4eec\u4f1a\u5728\u5bf9\u8c61\u4e0a\u9762\u8bbe\u7f6e\u5185\u90e8\u5c5e\u6027\uff0c\u5c5e\u6027\u540d\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4f7f\u7528\u4e0b\u5212\u7ebf\u5f00\u5934\uff0c\u8868\u793a\u8fd9\u4e9b\u5c5e\u6027\u4e0d\u5e94\u8be5\u88ab\u5916\u90e8\u4f7f\u7528\u3002\u7ed3\u5408<code>get</code>\u548c<code>set</code>\u65b9\u6cd5\uff0c\u5c31\u53ef\u4ee5\u505a\u5230\u9632\u6b62\u8fd9\u4e9b\u5185\u90e8\u5c5e\u6027\u88ab\u5916\u90e8\u8bfb\u5199\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> handler = {\n  <span class="hljs-keyword">get</span> (target, key) {\n    invariant(key, <span class="hljs-string">\'get\'</span>);\n    <span class="hljs-keyword">return</span> target[key];\n  },\n  <span class="hljs-keyword">set</span> (target, key, value) {\n    invariant(key, <span class="hljs-string">\'set\'</span>);\n    target[key] = value;\n    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;\n  }\n};\n<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">invariant</span> (<span class="hljs-params">key, action</span>) </span>{\n  <span class="hljs-keyword">if</span> (key[<span class="hljs-number">0</span>] === <span class="hljs-string">\'_\'</span>) {\n    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Invalid attempt to <span class="hljs-subst">${action}</span> private "<span class="hljs-subst">${key}</span>" property`</span>);\n  }\n}\n<span class="hljs-keyword">const</span> target = {};\n<span class="hljs-keyword">const</span> proxy = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(target, handler);\nproxy._prop\n<span class="hljs-comment">// Error: Invalid attempt to get private "_prop" property</span>\nproxy._prop = <span class="hljs-string">\'c\'</span>\n<span class="hljs-comment">// Error: Invalid attempt to set private "_prop" property</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u53ea\u8981\u8bfb\u5199\u7684\u5c5e\u6027\u540d\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u662f\u4e0b\u5212\u7ebf\uff0c\u4e00\u5f8b\u629b\u9519\uff0c\u4ece\u800c\u8fbe\u5230\u7981\u6b62\u8bfb\u5199\u5185\u90e8\u5c5e\u6027\u7684\u76ee\u7684\u3002</p>\n<p>\u4e0b\u9762\u662f<code>set</code>\u65b9\u6cd5\u7b2c\u56db\u4e2a\u53c2\u6570\u7684\u4f8b\u5b50\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> handler = {\n  <span class="hljs-keyword">set</span>: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(obj, prop, value, receiver)</span> </span>{\n    obj[prop] = receiver;\n  }\n};\n<span class="hljs-keyword">const</span> proxy = <span class="hljs-keyword">new</span> Proxy({}, handler);\nproxy.foo = <span class="hljs-string">\'bar\'</span>;\nproxy.foo === proxy <span class="hljs-comment">// true</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>set</code>\u65b9\u6cd5\u7684\u7b2c\u56db\u4e2a\u53c2\u6570<code>receiver</code>\uff0c\u603b\u662f\u8fd4\u56de<code>this</code>\u5173\u952e\u5b57\u6240\u6307\u5411\u7684\u90a3\u4e2a\u5bf9\u8c61\uff0c\u5373<code>proxy</code>\u5b9e\u4f8b\u672c\u8eab\u3002</p>\n<p>\u6ce8\u610f\uff0c\u5982\u679c\u76ee\u6807\u5bf9\u8c61\u81ea\u8eab\u7684\u67d0\u4e2a\u5c5e\u6027\uff0c\u4e0d\u53ef\u5199\u4e5f\u4e0d\u53ef\u914d\u7f6e\uff0c\u90a3\u4e48<code>set</code>\u4e0d\u5f97\u6539\u53d8\u8fd9\u4e2a\u5c5e\u6027\u7684\u503c\uff0c\u53ea\u80fd\u8fd4\u56de\u540c\u6837\u7684\u503c\uff0c\u5426\u5219\u62a5\u9519\u3002</p>\n<h3 id="apply">apply()</h3>\n<p><code>apply</code>\u65b9\u6cd5\u62e6\u622a\u51fd\u6570\u7684\u8c03\u7528\u3001<code>call</code>\u548c<code>apply</code>\u64cd\u4f5c\u3002</p>\n<p><code>apply</code>\u65b9\u6cd5\u53ef\u4ee5\u63a5\u53d7\u4e09\u4e2a\u53c2\u6570\uff0c\u5206\u522b\u662f\u76ee\u6807\u5bf9\u8c61\u3001\u76ee\u6807\u5bf9\u8c61\u7684\u4e0a\u4e0b\u6587\u5bf9\u8c61\uff08<code>this</code>\uff09\u548c\u76ee\u6807\u5bf9\u8c61\u7684\u53c2\u6570\u6570\u7ec4\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-built_in">var</span> handler = {\n  <span class="hljs-built_in">apply</span> (target, ctx, <span class="hljs-built_in">args</span>) {\n    <span class="hljs-built_in">return</span> Reflect.<span class="hljs-built_in">apply</span>(...arguments);\n  }\n};</code></pre>\n<p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">var</span> target = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-string">\'I am the target\'</span>; };\n<span class="hljs-keyword">var</span> handler = {\n  <span class="hljs-attr">apply</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{\n    <span class="hljs-keyword">return</span> <span class="hljs-string">\'I am the proxy\'</span>;\n  }\n};\n\n<span class="hljs-keyword">var</span> p = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(target, handler);\n\np()\n<span class="hljs-comment">// "I am the proxy"</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u53d8\u91cf<code>p</code>\u662f Proxy \u7684\u5b9e\u4f8b\uff0c\u5f53\u5b83\u4f5c\u4e3a\u51fd\u6570\u8c03\u7528\u65f6\uff08<code>p()</code>\uff09\uff0c\u5c31\u4f1a\u88ab<code>apply</code>\u65b9\u6cd5\u62e6\u622a\uff0c\u8fd4\u56de\u4e00\u4e2a\u5b57\u7b26\u4e32\u3002</p>\n<p>\u4e0b\u9762\u662f\u53e6\u5916\u4e00\u4e2a\u4f8b\u5b50\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">var</span> twice = {\n  apply (target, ctx, args) {\n    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Reflect</span>.apply(...arguments) * <span class="hljs-number">2</span>;\n  }\n};\n<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sum</span> (<span class="hljs-params">left, right</span>) </span>{\n  <span class="hljs-keyword">return</span> left + right;\n};\n<span class="hljs-keyword">var</span> proxy = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(sum, twice);\nproxy(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>) <span class="hljs-comment">// 6</span>\nproxy.call(<span class="hljs-literal">null</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>) <span class="hljs-comment">// 22</span>\nproxy.apply(<span class="hljs-literal">null</span>, [<span class="hljs-number">7</span>, <span class="hljs-number">8</span>]) <span class="hljs-comment">// 30</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u6bcf\u5f53\u6267\u884c<code>proxy</code>\u51fd\u6570\uff08\u76f4\u63a5\u8c03\u7528\u6216<code>call</code>\u548c<code>apply</code>\u8c03\u7528\uff09\uff0c\u5c31\u4f1a\u88ab<code>apply</code>\u65b9\u6cd5\u62e6\u622a\u3002</p>\n<p>\u53e6\u5916\uff0c\u76f4\u63a5\u8c03\u7528<code>Reflect.apply</code>\u65b9\u6cd5\uff0c\u4e5f\u4f1a\u88ab\u62e6\u622a\u3002</p>\n<pre><code class="language-javascript">Reflect.apply(proxy, <span class="hljs-literal">null</span>, [<span class="hljs-number">9</span>, <span class="hljs-number">10</span>]) <span class="hljs-comment">// 38</span></code></pre>\n<h3 id="has">has()</h3>\n<p><code>has</code>\u65b9\u6cd5\u7528\u6765\u62e6\u622a<code>HasProperty</code>\u64cd\u4f5c\uff0c\u5373\u5224\u65ad\u5bf9\u8c61\u662f\u5426\u5177\u6709\u67d0\u4e2a\u5c5e\u6027\u65f6\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u4f1a\u751f\u6548\u3002\u5178\u578b\u7684\u64cd\u4f5c\u5c31\u662f<code>in</code>\u8fd0\u7b97\u7b26\u3002</p>\n<p>\u4e0b\u9762\u7684\u4f8b\u5b50\u4f7f\u7528<code>has</code>\u65b9\u6cd5\u9690\u85cf\u67d0\u4e9b\u5c5e\u6027\uff0c\u4e0d\u88ab<code>in</code>\u8fd0\u7b97\u7b26\u53d1\u73b0\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">var</span> handler = {\n  has (target, key) {\n    <span class="hljs-keyword">if</span> (key[<span class="hljs-number">0</span>] === <span class="hljs-string">\'_\'</span>) {\n      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;\n    }\n    <span class="hljs-keyword">return</span> key <span class="hljs-keyword">in</span> target;\n  }\n};\n<span class="hljs-keyword">var</span> target = { <span class="hljs-attr">_prop</span>: <span class="hljs-string">\'foo\'</span>, <span class="hljs-attr">prop</span>: <span class="hljs-string">\'foo\'</span> };\n<span class="hljs-keyword">var</span> proxy = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(target, handler);\n<span class="hljs-string">\'_prop\'</span> <span class="hljs-keyword">in</span> proxy <span class="hljs-comment">// false</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u5982\u679c\u539f\u5bf9\u8c61\u7684\u5c5e\u6027\u540d\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u662f\u4e0b\u5212\u7ebf\uff0c<code>proxy.has</code>\u5c31\u4f1a\u8fd4\u56de<code>false</code>\uff0c\u4ece\u800c\u4e0d\u4f1a\u88ab<code>in</code>\u8fd0\u7b97\u7b26\u53d1\u73b0\u3002</p>\n<p>\u5982\u679c\u539f\u5bf9\u8c61\u4e0d\u53ef\u914d\u7f6e\u6216\u8005\u7981\u6b62\u6269\u5c55\uff0c\u8fd9\u65f6<code>has</code>\u62e6\u622a\u4f1a\u62a5\u9519\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">var</span> obj = { <span class="hljs-attr">a</span>: <span class="hljs-number">10</span> };\n<span class="hljs-built_in">Object</span>.preventExtensions(obj);\n\n<span class="hljs-keyword">var</span> p = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(obj, {\n  <span class="hljs-attr">has</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">target, prop</span>) </span>{\n    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;\n  }\n});\n\n<span class="hljs-string">\'a\'</span> <span class="hljs-keyword">in</span> p <span class="hljs-comment">// TypeError is thrown</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>obj</code>\u5bf9\u8c61\u7981\u6b62\u6269\u5c55\uff0c\u7ed3\u679c\u4f7f\u7528<code>has</code>\u62e6\u622a\u5c31\u4f1a\u62a5\u9519\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u67d0\u4e2a\u5c5e\u6027\u4e0d\u53ef\u914d\u7f6e\uff08\u6216\u8005\u76ee\u6807\u5bf9\u8c61\u4e0d\u53ef\u6269\u5c55\uff09\uff0c\u5219<code>has</code>\u65b9\u6cd5\u5c31\u4e0d\u5f97\u201c\u9690\u85cf\u201d\uff08\u5373\u8fd4\u56de<code>false</code>\uff09\u76ee\u6807\u5bf9\u8c61\u7684\u8be5\u5c5e\u6027\u3002</p>\n<p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c<code>has</code>\u65b9\u6cd5\u62e6\u622a\u7684\u662f<code>HasProperty</code>\u64cd\u4f5c\uff0c\u800c\u4e0d\u662f<code>HasOwnProperty</code>\u64cd\u4f5c\uff0c\u5373<code>has</code>\u65b9\u6cd5\u4e0d\u5224\u65ad\u4e00\u4e2a\u5c5e\u6027\u662f\u5bf9\u8c61\u81ea\u8eab\u7684\u5c5e\u6027\uff0c\u8fd8\u662f\u7ee7\u627f\u7684\u5c5e\u6027\u3002</p>\n<p>\u53e6\u5916\uff0c\u867d\u7136<code>for...in</code>\u5faa\u73af\u4e5f\u7528\u5230\u4e86<code>in</code>\u8fd0\u7b97\u7b26\uff0c\u4f46\u662f<code>has</code>\u62e6\u622a\u5bf9<code>for...in</code>\u5faa\u73af\u4e0d\u751f\u6548\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">let</span> stu1 = {<span class="hljs-attr">name</span>: <span class="hljs-string">\'\u5f20\u4e09\'</span>, <span class="hljs-attr">score</span>: <span class="hljs-number">59</span>};\n<span class="hljs-keyword">let</span> stu2 = {<span class="hljs-attr">name</span>: <span class="hljs-string">\'\u674e\u56db\'</span>, <span class="hljs-attr">score</span>: <span class="hljs-number">99</span>};\n\n<span class="hljs-keyword">let</span> handler = {\n  has(target, prop) {\n    <span class="hljs-keyword">if</span> (prop === <span class="hljs-string">\'score\'</span> &amp;&amp; target[prop] &lt; <span class="hljs-number">60</span>) {\n      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${target.name}</span> \u4e0d\u53ca\u683c`</span>);\n      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;\n    }\n    <span class="hljs-keyword">return</span> prop <span class="hljs-keyword">in</span> target;\n  }\n}\n\n<span class="hljs-keyword">let</span> oproxy1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(stu1, handler);\n<span class="hljs-keyword">let</span> oproxy2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(stu2, handler);\n\n<span class="hljs-string">\'score\'</span> <span class="hljs-keyword">in</span> oproxy1\n<span class="hljs-comment">// \u5f20\u4e09 \u4e0d\u53ca\u683c</span>\n<span class="hljs-comment">// false</span>\n\n<span class="hljs-string">\'score\'</span> <span class="hljs-keyword">in</span> oproxy2\n<span class="hljs-comment">// true</span>\n\n<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> a <span class="hljs-keyword">in</span> oproxy1) {\n  <span class="hljs-built_in">console</span>.log(oproxy1[a]);\n}\n<span class="hljs-comment">// \u5f20\u4e09</span>\n<span class="hljs-comment">// 59</span>\n\n<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> b <span class="hljs-keyword">in</span> oproxy2) {\n  <span class="hljs-built_in">console</span>.log(oproxy2[b]);\n}\n<span class="hljs-comment">// \u674e\u56db</span>\n<span class="hljs-comment">// 99</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>has</code>\u62e6\u622a\u53ea\u5bf9<code>in</code>\u5faa\u73af\u751f\u6548\uff0c\u5bf9<code>for...in</code>\u5faa\u73af\u4e0d\u751f\u6548\uff0c\u5bfc\u81f4\u4e0d\u7b26\u5408\u8981\u6c42\u7684\u5c5e\u6027\u6ca1\u6709\u88ab\u6392\u9664\u5728<code>for...in</code>\u5faa\u73af\u4e4b\u5916\u3002</p>\n<h3 id="construct">construct()</h3>\n<p><code>construct</code>\u65b9\u6cd5\u7528\u4e8e\u62e6\u622a<code>new</code>\u547d\u4ee4\uff0c\u4e0b\u9762\u662f\u62e6\u622a\u5bf9\u8c61\u7684\u5199\u6cd5\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">var</span> handler = {\n  construct (target, args, <span class="hljs-keyword">new</span><span class="hljs-type">Target</span>) {\n    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-type">target</span>(...args);\n  }\n};</code></pre>\n<p><code>construct</code>\u65b9\u6cd5\u53ef\u4ee5\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570\u3002</p>\n<ul>\n<li><code>target</code>: \u76ee\u6807\u5bf9\u8c61</li>\n<li><code>args</code>\uff1a\u6784\u5efa\u51fd\u6570\u7684\u53c2\u6570\u5bf9\u8c61</li>\n</ul>\n<p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">var</span> p = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{}, {\n  <span class="hljs-attr">construct</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">target, args</span>) </span>{\n    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">\'called: \'</span> + args.join(<span class="hljs-string">\', \'</span>));\n    <span class="hljs-keyword">return</span> { <span class="hljs-attr">value</span>: args[<span class="hljs-number">0</span>] * <span class="hljs-number">10</span> };\n  }\n});\n\n(<span class="hljs-keyword">new</span> p(<span class="hljs-number">1</span>)).value\n<span class="hljs-comment">// "called: 1"</span>\n<span class="hljs-comment">// 10</span></code></pre>\n<p><code>construct</code>\u65b9\u6cd5\u8fd4\u56de\u7684\u5fc5\u987b\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5426\u5219\u4f1a\u62a5\u9519\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">var</span> p = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{}, {\n  <span class="hljs-attr">construct</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">target, argumentsList</span>) </span>{\n    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;\n  }\n});\n\n<span class="hljs-keyword">new</span> p() <span class="hljs-comment">// \u62a5\u9519</span></code></pre>\n<h3 id="deleteproperty">deleteProperty()</h3>\n<p><code>deleteProperty</code>\u65b9\u6cd5\u7528\u4e8e\u62e6\u622a<code>delete</code>\u64cd\u4f5c\uff0c\u5982\u679c\u8fd9\u4e2a\u65b9\u6cd5\u629b\u51fa\u9519\u8bef\u6216\u8005\u8fd4\u56de<code>false</code>\uff0c\u5f53\u524d\u5c5e\u6027\u5c31\u65e0\u6cd5\u88ab<code>delete</code>\u547d\u4ee4\u5220\u9664\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">var</span> handler = {\n  deleteProperty (target, key) {\n    invariant(key, <span class="hljs-string">\'delete\'</span>);\n    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;\n  }\n};\n<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">invariant</span> (<span class="hljs-params">key, action</span>) </span>{\n  <span class="hljs-keyword">if</span> (key[<span class="hljs-number">0</span>] === <span class="hljs-string">\'_\'</span>) {\n    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Invalid attempt to <span class="hljs-subst">${action}</span> private "<span class="hljs-subst">${key}</span>" property`</span>);\n  }\n}\n\n<span class="hljs-keyword">var</span> target = { <span class="hljs-attr">_prop</span>: <span class="hljs-string">\'foo\'</span> };\n<span class="hljs-keyword">var</span> proxy = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(target, handler);\n<span class="hljs-keyword">delete</span> proxy._prop\n<span class="hljs-comment">// Error: Invalid attempt to delete private "_prop" property</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>deleteProperty</code>\u65b9\u6cd5\u62e6\u622a\u4e86<code>delete</code>\u64cd\u4f5c\u7b26\uff0c\u5220\u9664\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e3a\u4e0b\u5212\u7ebf\u7684\u5c5e\u6027\u4f1a\u62a5\u9519\u3002</p>\n<p>\u6ce8\u610f\uff0c\u76ee\u6807\u5bf9\u8c61\u81ea\u8eab\u7684\u4e0d\u53ef\u914d\u7f6e\uff08configurable\uff09\u7684\u5c5e\u6027\uff0c\u4e0d\u80fd\u88ab<code>deleteProperty</code>\u65b9\u6cd5\u5220\u9664\uff0c\u5426\u5219\u62a5\u9519\u3002</p>\n<h3 id="defineproperty">defineProperty()</h3>\n<p><code>defineProperty</code>\u65b9\u6cd5\u62e6\u622a\u4e86<code>Object.defineProperty</code>\u64cd\u4f5c\u3002</p>\n<pre><code class="language-javascript">var <span class="hljs-keyword">handler</span> = {\n  defineProperty (<span class="hljs-keyword">target</span>, key, descriptor) {\n    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;\n  }\n};\nvar <span class="hljs-keyword">target</span> = {};\nvar proxy = <span class="hljs-keyword">new</span> Proxy(<span class="hljs-keyword">target</span>, <span class="hljs-keyword">handler</span>);\nproxy.foo = <span class="hljs-string">\'bar\'</span>\n<span class="hljs-comment">// TypeError: proxy defineProperty handler returned false for property \'"foo"\'</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>defineProperty</code>\u65b9\u6cd5\u8fd4\u56de<code>false</code>\uff0c\u5bfc\u81f4\u6dfb\u52a0\u65b0\u5c5e\u6027\u4f1a\u629b\u51fa\u9519\u8bef\u3002</p>\n<p>\u6ce8\u610f\uff0c\u5982\u679c\u76ee\u6807\u5bf9\u8c61\u4e0d\u53ef\u6269\u5c55\uff08extensible\uff09\uff0c\u5219<code>defineProperty</code>\u4e0d\u80fd\u589e\u52a0\u76ee\u6807\u5bf9\u8c61\u4e0a\u4e0d\u5b58\u5728\u7684\u5c5e\u6027\uff0c\u5426\u5219\u4f1a\u62a5\u9519\u3002\u53e6\u5916\uff0c\u5982\u679c\u76ee\u6807\u5bf9\u8c61\u7684\u67d0\u4e2a\u5c5e\u6027\u4e0d\u53ef\u5199\uff08writable\uff09\u6216\u4e0d\u53ef\u914d\u7f6e\uff08configurable\uff09\uff0c\u5219<code>defineProperty</code>\u65b9\u6cd5\u4e0d\u5f97\u6539\u53d8\u8fd9\u4e24\u4e2a\u8bbe\u7f6e\u3002</p>\n<h3 id="getownpropertydescriptor">getOwnPropertyDescriptor()</h3>\n<p><code>getOwnPropertyDescriptor</code>\u65b9\u6cd5\u62e6\u622a<code>Object.getOwnPropertyDescriptor()</code>\uff0c\u8fd4\u56de\u4e00\u4e2a\u5c5e\u6027\u63cf\u8ff0\u5bf9\u8c61\u6216\u8005<code>undefined</code>\u3002</p>\n<pre><code class="language-javascript">var handler = {\n  getOwnPropertyDescriptor (target, key) {\n    <span class="hljs-keyword">if</span> (key<span class="hljs-literal">[<span class="hljs-number">0</span>]</span><span class="hljs-operator"> === </span><span class="hljs-character">\'_\'</span>) {\n      return;\n    }\n    return <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Object</span>.</span></span>get<span class="hljs-constructor">OwnPropertyDescriptor(<span class="hljs-params">target</span>, <span class="hljs-params">key</span>)</span>;\n  }\n};\nvar target = { _foo: \'bar\', baz: \'tar\' };\nvar proxy = <span class="hljs-keyword">new</span> <span class="hljs-constructor">Proxy(<span class="hljs-params">target</span>, <span class="hljs-params">handler</span>)</span>;\n<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Object</span>.</span></span>get<span class="hljs-constructor">OwnPropertyDescriptor(<span class="hljs-params">proxy</span>, \'<span class="hljs-params">wat</span>\')</span>\n<span class="hljs-comment">// undefined</span>\n<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Object</span>.</span></span>get<span class="hljs-constructor">OwnPropertyDescriptor(<span class="hljs-params">proxy</span>, \'<span class="hljs-params">_foo</span>\')</span>\n<span class="hljs-comment">// undefined</span>\n<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Object</span>.</span></span>get<span class="hljs-constructor">OwnPropertyDescriptor(<span class="hljs-params">proxy</span>, \'<span class="hljs-params">baz</span>\')</span>\n<span class="hljs-comment">// { value: \'tar\', writable: true, enumerable: true, configurable: true }</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>handler.getOwnPropertyDescriptor</code>\u65b9\u6cd5\u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e3a\u4e0b\u5212\u7ebf\u7684\u5c5e\u6027\u540d\u4f1a\u8fd4\u56de<code>undefined</code>\u3002</p>\n<h3 id="getprototypeof">getPrototypeOf()</h3>\n<p><code>getPrototypeOf</code>\u65b9\u6cd5\u4e3b\u8981\u7528\u6765\u62e6\u622a\u83b7\u53d6\u5bf9\u8c61\u539f\u578b\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u62e6\u622a\u4e0b\u9762\u8fd9\u4e9b\u64cd\u4f5c\u3002</p>\n<ul>\n<li><code>Object.prototype.__proto__</code></li>\n<li><code>Object.prototype.isPrototypeOf()</code></li>\n<li><code>Object.getPrototypeOf()</code></li>\n<li><code>Reflect.getPrototypeOf()</code></li>\n<li><code>instanceof</code></li>\n</ul>\n<p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">var</span> proto = {};\n<span class="hljs-keyword">var</span> p = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>({}, {\n  getPrototypeOf(target) {\n    <span class="hljs-keyword">return</span> proto;\n  }\n});\n<span class="hljs-built_in">Object</span>.getPrototypeOf(p) === proto <span class="hljs-comment">// true</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>getPrototypeOf</code>\u65b9\u6cd5\u62e6\u622a<code>Object.getPrototypeOf()</code>\uff0c\u8fd4\u56de<code>proto</code>\u5bf9\u8c61\u3002</p>\n<p>\u6ce8\u610f\uff0c<code>getPrototypeOf</code>\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u5fc5\u987b\u662f\u5bf9\u8c61\u6216\u8005<code>null</code>\uff0c\u5426\u5219\u62a5\u9519\u3002\u53e6\u5916\uff0c\u5982\u679c\u76ee\u6807\u5bf9\u8c61\u4e0d\u53ef\u6269\u5c55\uff08extensible\uff09\uff0c <code>getPrototypeOf</code>\u65b9\u6cd5\u5fc5\u987b\u8fd4\u56de\u76ee\u6807\u5bf9\u8c61\u7684\u539f\u578b\u5bf9\u8c61\u3002</p>\n<h3 id="isextensible">isExtensible()</h3>\n<p><code>isExtensible</code>\u65b9\u6cd5\u62e6\u622a<code>Object.isExtensible</code>\u64cd\u4f5c\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">var</span> p = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>({}, {\n  <span class="hljs-attr">isExtensible</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">target</span>) </span>{\n    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"called"</span>);\n    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;\n  }\n});\n\n<span class="hljs-built_in">Object</span>.isExtensible(p)\n<span class="hljs-comment">// "called"</span>\n<span class="hljs-comment">// true</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u8bbe\u7f6e\u4e86<code>isExtensible</code>\u65b9\u6cd5\uff0c\u5728\u8c03\u7528<code>Object.isExtensible</code>\u65f6\u4f1a\u8f93\u51fa<code>called</code>\u3002</p>\n<p>\u6ce8\u610f\uff0c\u8be5\u65b9\u6cd5\u53ea\u80fd\u8fd4\u56de\u5e03\u5c14\u503c\uff0c\u5426\u5219\u8fd4\u56de\u503c\u4f1a\u88ab\u81ea\u52a8\u8f6c\u4e3a\u5e03\u5c14\u503c\u3002</p>\n<p>\u8fd9\u4e2a\u65b9\u6cd5\u6709\u4e00\u4e2a\u5f3a\u9650\u5236\uff0c\u5b83\u7684\u8fd4\u56de\u503c\u5fc5\u987b\u4e0e\u76ee\u6807\u5bf9\u8c61\u7684<code>isExtensible</code>\u5c5e\u6027\u4fdd\u6301\u4e00\u81f4\uff0c\u5426\u5219\u5c31\u4f1a\u629b\u51fa\u9519\u8bef\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Object</span>.</span></span>is<span class="hljs-constructor">Extensible(<span class="hljs-params">proxy</span>)</span><span class="hljs-operator"> === </span><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Object</span>.</span></span>is<span class="hljs-constructor">Extensible(<span class="hljs-params">target</span>)</span></code></pre>\n<p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">var</span> p = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>({}, {\n  <span class="hljs-attr">isExtensible</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">target</span>) </span>{\n    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;\n  }\n});\n\n<span class="hljs-built_in">Object</span>.isExtensible(p) <span class="hljs-comment">// \u62a5\u9519</span></code></pre>\n<h3 id="ownkeys">ownKeys()</h3>\n<p><code>ownKeys</code>\u65b9\u6cd5\u7528\u6765\u62e6\u622a\u5bf9\u8c61\u81ea\u8eab\u5c5e\u6027\u7684\u8bfb\u53d6\u64cd\u4f5c\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u62e6\u622a\u4ee5\u4e0b\u64cd\u4f5c\u3002</p>\n<ul>\n<li><code>Object.getOwnPropertyNames()</code></li>\n<li><code>Object.getOwnPropertySymbols()</code></li>\n<li><code>Object.keys()</code></li>\n</ul>\n<p>\u4e0b\u9762\u662f\u62e6\u622a<code>Object.keys()</code>\u7684\u4f8b\u5b50\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">let</span> target = {\n  a: <span class="hljs-number">1</span>,\n  b: <span class="hljs-number">2</span>,\n  c: <span class="hljs-number">3</span>\n};\n\n<span class="hljs-keyword">let</span> handler = {\n  own<span class="hljs-constructor">Keys(<span class="hljs-params">target</span>)</span> {\n    return <span class="hljs-literal">[\'<span class="hljs-identifier">a</span>\']</span>;\n  }\n};\n\n<span class="hljs-keyword">let</span> proxy = <span class="hljs-keyword">new</span> <span class="hljs-constructor">Proxy(<span class="hljs-params">target</span>, <span class="hljs-params">handler</span>)</span>;\n\n<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Object</span>.</span></span>keys(proxy)\n<span class="hljs-comment">// [ \'a\' ]</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u62e6\u622a\u4e86\u5bf9\u4e8e<code>target</code>\u5bf9\u8c61\u7684<code>Object.keys()</code>\u64cd\u4f5c\uff0c\u53ea\u8fd4\u56de<code>a</code>\u3001<code>b</code>\u3001<code>c</code>\u4e09\u4e2a\u5c5e\u6027\u4e4b\u4e2d\u7684<code>a</code>\u5c5e\u6027\u3002</p>\n<p>\u4e0b\u9762\u7684\u4f8b\u5b50\u662f\u62e6\u622a\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e3a\u4e0b\u5212\u7ebf\u7684\u5c5e\u6027\u540d\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">let</span> target = {\n  <span class="hljs-attr">_bar</span>: <span class="hljs-string">\'foo\'</span>,\n  <span class="hljs-attr">_prop</span>: <span class="hljs-string">\'bar\'</span>,\n  <span class="hljs-attr">prop</span>: <span class="hljs-string">\'baz\'</span>\n};\n\n<span class="hljs-keyword">let</span> handler = {\n  ownKeys (target) {\n    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Reflect</span>.ownKeys(target).filter(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> key[<span class="hljs-number">0</span>] !== <span class="hljs-string">\'_\'</span>);\n  }\n};\n\n<span class="hljs-keyword">let</span> proxy = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(target, handler);\n<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">of</span> <span class="hljs-built_in">Object</span>.keys(proxy)) {\n  <span class="hljs-built_in">console</span>.log(target[key]);\n}\n<span class="hljs-comment">// "baz"</span></code></pre>\n<p>\u6ce8\u610f\uff0c\u4f7f\u7528<code>Object.keys</code>\u65b9\u6cd5\u65f6\uff0c\u6709\u4e09\u7c7b\u5c5e\u6027\u4f1a\u88ab<code>ownKeys</code>\u65b9\u6cd5\u81ea\u52a8\u8fc7\u6ee4\uff0c\u4e0d\u4f1a\u8fd4\u56de\u3002</p>\n<ul>\n<li>\u76ee\u6807\u5bf9\u8c61\u4e0a\u4e0d\u5b58\u5728\u7684\u5c5e\u6027</li>\n<li>\u5c5e\u6027\u540d\u4e3a Symbol \u503c</li>\n<li>\u4e0d\u53ef\u904d\u5386\uff08<code>enumerable</code>\uff09\u7684\u5c5e\u6027</li>\n</ul>\n<pre><code class="language-javascript"><span class="hljs-keyword">let</span> target = {\n  <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>,\n  <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>,\n  <span class="hljs-attr">c</span>: <span class="hljs-number">3</span>,\n  [<span class="hljs-built_in">Symbol</span>.for(<span class="hljs-string">\'secret\'</span>)]: <span class="hljs-string">\'4\'</span>,\n};\n\n<span class="hljs-built_in">Object</span>.defineProperty(target, <span class="hljs-string">\'key\'</span>, {\n  <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">false</span>,\n  <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,\n  <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>,\n  <span class="hljs-attr">value</span>: <span class="hljs-string">\'static\'</span>\n});\n\n<span class="hljs-keyword">let</span> handler = {\n  ownKeys(target) {\n    <span class="hljs-keyword">return</span> [<span class="hljs-string">\'a\'</span>, <span class="hljs-string">\'d\'</span>, <span class="hljs-built_in">Symbol</span>.for(<span class="hljs-string">\'secret\'</span>), <span class="hljs-string">\'key\'</span>];\n  }\n};\n\n<span class="hljs-keyword">let</span> proxy = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(target, handler);\n\n<span class="hljs-built_in">Object</span>.keys(proxy)\n<span class="hljs-comment">// [\'a\']</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>ownKeys</code>\u65b9\u6cd5\u4e4b\u4e2d\uff0c\u663e\u5f0f\u8fd4\u56de\u4e0d\u5b58\u5728\u7684\u5c5e\u6027\uff08<code>d</code>\uff09\u3001Symbol \u503c\uff08<code>Symbol.for(&#39;secret&#39;)</code>\uff09\u3001\u4e0d\u53ef\u904d\u5386\u7684\u5c5e\u6027\uff08<code>key</code>\uff09\uff0c\u7ed3\u679c\u90fd\u88ab\u81ea\u52a8\u8fc7\u6ee4\u6389\u3002</p>\n<p><code>ownKeys</code>\u65b9\u6cd5\u8fd8\u53ef\u4ee5\u62e6\u622a<code>Object.getOwnPropertyNames()</code>\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">var</span> p = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>({}, {\n  <span class="hljs-attr">ownKeys</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">target</span>) </span>{\n    <span class="hljs-keyword">return</span> [<span class="hljs-string">\'a\'</span>, <span class="hljs-string">\'b\'</span>, <span class="hljs-string">\'c\'</span>];\n  }\n});\n\n<span class="hljs-built_in">Object</span>.getOwnPropertyNames(p)\n<span class="hljs-comment">// [ \'a\', \'b\', \'c\' ]</span></code></pre>\n<p><code>ownKeys</code>\u65b9\u6cd5\u8fd4\u56de\u7684\u6570\u7ec4\u6210\u5458\uff0c\u53ea\u80fd\u662f\u5b57\u7b26\u4e32\u6216 Symbol \u503c\u3002\u5982\u679c\u6709\u5176\u4ed6\u7c7b\u578b\u7684\u503c\uff0c\u6216\u8005\u8fd4\u56de\u7684\u6839\u672c\u4e0d\u662f\u6570\u7ec4\uff0c\u5c31\u4f1a\u62a5\u9519\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">var</span> obj = {};\n\n<span class="hljs-keyword">var</span> p = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(obj, {\n  <span class="hljs-attr">ownKeys</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">target</span>) </span>{\n    <span class="hljs-keyword">return</span> [<span class="hljs-number">123</span>, <span class="hljs-literal">true</span>, <span class="hljs-literal">undefined</span>, <span class="hljs-literal">null</span>, {}, []];\n  }\n});\n\n<span class="hljs-built_in">Object</span>.getOwnPropertyNames(p)\n<span class="hljs-comment">// Uncaught TypeError: 123 is not a valid property name</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>ownKeys</code>\u65b9\u6cd5\u867d\u7136\u8fd4\u56de\u4e00\u4e2a\u6570\u7ec4\uff0c\u4f46\u662f\u6bcf\u4e00\u4e2a\u6570\u7ec4\u6210\u5458\u90fd\u4e0d\u662f\u5b57\u7b26\u4e32\u6216 Symbol \u503c\uff0c\u56e0\u6b64\u5c31\u62a5\u9519\u4e86\u3002</p>\n<p>\u5982\u679c\u76ee\u6807\u5bf9\u8c61\u81ea\u8eab\u5305\u542b\u4e0d\u53ef\u914d\u7f6e\u7684\u5c5e\u6027\uff0c\u5219\u8be5\u5c5e\u6027\u5fc5\u987b\u88ab<code>ownKeys</code>\u65b9\u6cd5\u8fd4\u56de\uff0c\u5426\u5219\u62a5\u9519\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">var</span> obj = {};\n<span class="hljs-built_in">Object</span>.defineProperty(obj, <span class="hljs-string">\'a\'</span>, {\n  <span class="hljs-attr">configurable</span>: <span class="hljs-literal">false</span>,\n  <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,\n  <span class="hljs-attr">value</span>: <span class="hljs-number">10</span> }\n);\n\n<span class="hljs-keyword">var</span> p = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(obj, {\n  <span class="hljs-attr">ownKeys</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">target</span>) </span>{\n    <span class="hljs-keyword">return</span> [<span class="hljs-string">\'b\'</span>];\n  }\n});\n\n<span class="hljs-built_in">Object</span>.getOwnPropertyNames(p)\n<span class="hljs-comment">// Uncaught TypeError: \'ownKeys\' on proxy: trap result did not include \'a\'</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>obj</code>\u5bf9\u8c61\u7684<code>a</code>\u5c5e\u6027\u662f\u4e0d\u53ef\u914d\u7f6e\u7684\uff0c\u8fd9\u65f6<code>ownKeys</code>\u65b9\u6cd5\u8fd4\u56de\u7684\u6570\u7ec4\u4e4b\u4e2d\uff0c\u5fc5\u987b\u5305\u542b<code>a</code>\uff0c\u5426\u5219\u4f1a\u62a5\u9519\u3002</p>\n<p>\u53e6\u5916\uff0c\u5982\u679c\u76ee\u6807\u5bf9\u8c61\u662f\u4e0d\u53ef\u6269\u5c55\u7684\uff08non-extensition\uff09\uff0c\u8fd9\u65f6<code>ownKeys</code>\u65b9\u6cd5\u8fd4\u56de\u7684\u6570\u7ec4\u4e4b\u4e2d\uff0c\u5fc5\u987b\u5305\u542b\u539f\u5bf9\u8c61\u7684\u6240\u6709\u5c5e\u6027\uff0c\u4e14\u4e0d\u80fd\u5305\u542b\u591a\u4f59\u7684\u5c5e\u6027\uff0c\u5426\u5219\u62a5\u9519\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">var</span> obj = {\n  <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>\n};\n\n<span class="hljs-built_in">Object</span>.preventExtensions(obj);\n\n<span class="hljs-keyword">var</span> p = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(obj, {\n  <span class="hljs-attr">ownKeys</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">target</span>) </span>{\n    <span class="hljs-keyword">return</span> [<span class="hljs-string">\'a\'</span>, <span class="hljs-string">\'b\'</span>];\n  }\n});\n\n<span class="hljs-built_in">Object</span>.getOwnPropertyNames(p)\n<span class="hljs-comment">// Uncaught TypeError: \'ownKeys\' on proxy: trap returned extra keys but proxy target is non-extensible</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>obj</code>\u5bf9\u8c61\u662f\u4e0d\u53ef\u6269\u5c55\u7684\uff0c\u8fd9\u65f6<code>ownKeys</code>\u65b9\u6cd5\u8fd4\u56de\u7684\u6570\u7ec4\u4e4b\u4e2d\uff0c\u5305\u542b\u4e86<code>obj</code>\u5bf9\u8c61\u7684\u591a\u4f59\u5c5e\u6027<code>b</code>\uff0c\u6240\u4ee5\u5bfc\u81f4\u4e86\u62a5\u9519\u3002</p>\n<h3 id="preventextensions">preventExtensions()</h3>\n<p><code>preventExtensions</code>\u65b9\u6cd5\u62e6\u622a<code>Object.preventExtensions()</code>\u3002\u8be5\u65b9\u6cd5\u5fc5\u987b\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u503c\uff0c\u5426\u5219\u4f1a\u88ab\u81ea\u52a8\u8f6c\u4e3a\u5e03\u5c14\u503c\u3002</p>\n<p>\u8fd9\u4e2a\u65b9\u6cd5\u6709\u4e00\u4e2a\u9650\u5236\uff0c\u53ea\u6709\u76ee\u6807\u5bf9\u8c61\u4e0d\u53ef\u6269\u5c55\u65f6\uff08\u5373<code>Object.isExtensible(proxy)</code>\u4e3a<code>false</code>\uff09\uff0c<code>proxy.preventExtensions</code>\u624d\u80fd\u8fd4\u56de<code>true</code>\uff0c\u5426\u5219\u4f1a\u62a5\u9519\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">var</span> p = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>({}, {\n  <span class="hljs-attr">preventExtensions</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">target</span>) </span>{\n    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;\n  }\n});\n\n<span class="hljs-built_in">Object</span>.preventExtensions(p) <span class="hljs-comment">// \u62a5\u9519</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>proxy.preventExtensions</code>\u65b9\u6cd5\u8fd4\u56de<code>true</code>\uff0c\u4f46\u8fd9\u65f6<code>Object.isExtensible(proxy)</code>\u4f1a\u8fd4\u56de<code>true</code>\uff0c\u56e0\u6b64\u62a5\u9519\u3002</p>\n<p>\u4e3a\u4e86\u9632\u6b62\u51fa\u73b0\u8fd9\u4e2a\u95ee\u9898\uff0c\u901a\u5e38\u8981\u5728<code>proxy.preventExtensions</code>\u65b9\u6cd5\u91cc\u9762\uff0c\u8c03\u7528\u4e00\u6b21<code>Object.preventExtensions</code>\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">var</span> p = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>({}, {\n  <span class="hljs-attr">preventExtensions</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">target</span>) </span>{\n    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">\'called\'</span>);\n    <span class="hljs-built_in">Object</span>.preventExtensions(target);\n    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;\n  }\n});\n\n<span class="hljs-built_in">Object</span>.preventExtensions(p)\n<span class="hljs-comment">// "called"</span>\n<span class="hljs-comment">// true</span></code></pre>\n<h3 id="setprototypeof">setPrototypeOf()</h3>\n<p><code>setPrototypeOf</code>\u65b9\u6cd5\u4e3b\u8981\u7528\u6765\u62e6\u622a<code>Object.setPrototypeOf</code>\u65b9\u6cd5\u3002</p>\n<p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\u3002</p>\n<pre><code class="language-javascript">var handler = {\n  setPrototypeOf (target, proto) {\n    throw <span class="hljs-keyword">new</span> <span class="hljs-constructor">Error(\'Changing <span class="hljs-params">the</span> <span class="hljs-params">prototype</span> <span class="hljs-params">is</span> <span class="hljs-params">forbidden</span>\')</span>;\n  }\n};\nvar proto = {};\nvar target = <span class="hljs-keyword">function</span> <span class="hljs-literal">()</span> {};\nvar proxy = <span class="hljs-keyword">new</span> <span class="hljs-constructor">Proxy(<span class="hljs-params">target</span>, <span class="hljs-params">handler</span>)</span>;\n<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Object</span>.</span></span>set<span class="hljs-constructor">PrototypeOf(<span class="hljs-params">proxy</span>, <span class="hljs-params">proto</span>)</span>;\n<span class="hljs-comment">// Error: Changing the prototype is forbidden</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u53ea\u8981\u4fee\u6539<code>target</code>\u7684\u539f\u578b\u5bf9\u8c61\uff0c\u5c31\u4f1a\u62a5\u9519\u3002</p>\n<p>\u6ce8\u610f\uff0c\u8be5\u65b9\u6cd5\u53ea\u80fd\u8fd4\u56de\u5e03\u5c14\u503c\uff0c\u5426\u5219\u4f1a\u88ab\u81ea\u52a8\u8f6c\u4e3a\u5e03\u5c14\u503c\u3002\u53e6\u5916\uff0c\u5982\u679c\u76ee\u6807\u5bf9\u8c61\u4e0d\u53ef\u6269\u5c55\uff08extensible\uff09\uff0c<code>setPrototypeOf</code>\u65b9\u6cd5\u4e0d\u5f97\u6539\u53d8\u76ee\u6807\u5bf9\u8c61\u7684\u539f\u578b\u3002</p>\n<h2 id="proxyrevocable">Proxy.revocable()</h2>\n<p><code>Proxy.revocable</code>\u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2a\u53ef\u53d6\u6d88\u7684 Proxy \u5b9e\u4f8b\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">let</span> target = {};\n<span class="hljs-keyword">let</span> handler = {};\n\n<span class="hljs-keyword">let</span> {proxy, revoke} = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Proxy</span>.</span></span>revocable(target, handler);\n\nproxy.foo = <span class="hljs-number">123</span>;\nproxy.foo <span class="hljs-comment">// 123</span>\n\nrevoke<span class="hljs-literal">()</span>;\nproxy.foo <span class="hljs-comment">// TypeError: Revoked</span></code></pre>\n<p><code>Proxy.revocable</code>\u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2a\u5bf9\u8c61\uff0c\u8be5\u5bf9\u8c61\u7684<code>proxy</code>\u5c5e\u6027\u662f<code>Proxy</code>\u5b9e\u4f8b\uff0c<code>revoke</code>\u5c5e\u6027\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u53ef\u4ee5\u53d6\u6d88<code>Proxy</code>\u5b9e\u4f8b\u3002\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u5f53\u6267\u884c<code>revoke</code>\u51fd\u6570\u4e4b\u540e\uff0c\u518d\u8bbf\u95ee<code>Proxy</code>\u5b9e\u4f8b\uff0c\u5c31\u4f1a\u629b\u51fa\u4e00\u4e2a\u9519\u8bef\u3002</p>\n<p><code>Proxy.revocable</code>\u7684\u4e00\u4e2a\u4f7f\u7528\u573a\u666f\u662f\uff0c\u76ee\u6807\u5bf9\u8c61\u4e0d\u5141\u8bb8\u76f4\u63a5\u8bbf\u95ee\uff0c\u5fc5\u987b\u901a\u8fc7\u4ee3\u7406\u8bbf\u95ee\uff0c\u4e00\u65e6\u8bbf\u95ee\u7ed3\u675f\uff0c\u5c31\u6536\u56de\u4ee3\u7406\u6743\uff0c\u4e0d\u5141\u8bb8\u518d\u6b21\u8bbf\u95ee\u3002</p>\n<h2 id="this-\u95ee\u9898">this \u95ee\u9898</h2>\n<p>\u867d\u7136 Proxy \u53ef\u4ee5\u4ee3\u7406\u9488\u5bf9\u76ee\u6807\u5bf9\u8c61\u7684\u8bbf\u95ee\uff0c\u4f46\u5b83\u4e0d\u662f\u76ee\u6807\u5bf9\u8c61\u7684\u900f\u660e\u4ee3\u7406\uff0c\u5373\u4e0d\u505a\u4efb\u4f55\u62e6\u622a\u7684\u60c5\u51b5\u4e0b\uff0c\u4e5f\u65e0\u6cd5\u4fdd\u8bc1\u4e0e\u76ee\u6807\u5bf9\u8c61\u7684\u884c\u4e3a\u4e00\u81f4\u3002\u4e3b\u8981\u539f\u56e0\u5c31\u662f\u5728 Proxy \u4ee3\u7406\u7684\u60c5\u51b5\u4e0b\uff0c\u76ee\u6807\u5bf9\u8c61\u5185\u90e8\u7684<code>this</code>\u5173\u952e\u5b57\u4f1a\u6307\u5411 Proxy \u4ee3\u7406\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> <span class="hljs-keyword">target</span> = {\n  m: function () {\n    console.log(<span class="hljs-keyword">this</span> === proxy);\n  }\n};\n<span class="hljs-keyword">const</span> <span class="hljs-keyword">handler</span> = {};\n\n<span class="hljs-keyword">const</span> proxy = <span class="hljs-keyword">new</span> Proxy(<span class="hljs-keyword">target</span>, <span class="hljs-keyword">handler</span>);\n\n<span class="hljs-keyword">target</span>.m() <span class="hljs-comment">// false</span>\nproxy.m()  <span class="hljs-comment">// true</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u4e00\u65e6<code>proxy</code>\u4ee3\u7406<code>target.m</code>\uff0c\u540e\u8005\u5185\u90e8\u7684<code>this</code>\u5c31\u662f\u6307\u5411<code>proxy</code>\uff0c\u800c\u4e0d\u662f<code>target</code>\u3002</p>\n<p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\uff0c\u7531\u4e8e<code>this</code>\u6307\u5411\u7684\u53d8\u5316\uff0c\u5bfc\u81f4 Proxy \u65e0\u6cd5\u4ee3\u7406\u76ee\u6807\u5bf9\u8c61\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> _name = <span class="hljs-keyword">new</span> <span class="hljs-built_in">WeakMap</span>();\n\n<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>{\n  <span class="hljs-keyword">constructor</span>(name) {\n    _name.set(<span class="hljs-keyword">this</span>, name);\n  }\n  <span class="hljs-keyword">get</span> name() {\n    <span class="hljs-keyword">return</span> _name.get(<span class="hljs-keyword">this</span>);\n  }\n}\n\n<span class="hljs-keyword">const</span> jane = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">\'Jane\'</span>);\njane.name <span class="hljs-comment">// \'Jane\'</span>\n\n<span class="hljs-keyword">const</span> proxy = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(jane, {});\nproxy.name <span class="hljs-comment">// undefined</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u76ee\u6807\u5bf9\u8c61<code>jane</code>\u7684<code>name</code>\u5c5e\u6027\uff0c\u5b9e\u9645\u4fdd\u5b58\u5728\u5916\u90e8<code>WeakMap</code>\u5bf9\u8c61<code>_name</code>\u4e0a\u9762\uff0c\u901a\u8fc7<code>this</code>\u952e\u533a\u5206\u3002\u7531\u4e8e\u901a\u8fc7<code>proxy.name</code>\u8bbf\u95ee\u65f6\uff0c<code>this</code>\u6307\u5411<code>proxy</code>\uff0c\u5bfc\u81f4\u65e0\u6cd5\u53d6\u5230\u503c\uff0c\u6240\u4ee5\u8fd4\u56de<code>undefined</code>\u3002</p>\n<p>\u6b64\u5916\uff0c\u6709\u4e9b\u539f\u751f\u5bf9\u8c61\u7684\u5185\u90e8\u5c5e\u6027\uff0c\u53ea\u6709\u901a\u8fc7\u6b63\u786e\u7684<code>this</code>\u624d\u80fd\u62ff\u5230\uff0c\u6240\u4ee5 Proxy \u4e5f\u65e0\u6cd5\u4ee3\u7406\u8fd9\u4e9b\u539f\u751f\u5bf9\u8c61\u7684\u5c5e\u6027\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> <span class="hljs-keyword">target</span> = <span class="hljs-keyword">new</span> Date();\n<span class="hljs-keyword">const</span> <span class="hljs-keyword">handler</span> = {};\n<span class="hljs-keyword">const</span> proxy = <span class="hljs-keyword">new</span> Proxy(<span class="hljs-keyword">target</span>, <span class="hljs-keyword">handler</span>);\n\nproxy.getDate();\n<span class="hljs-comment">// TypeError: this is not a Date object.</span></code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>getDate</code>\u65b9\u6cd5\u53ea\u80fd\u5728<code>Date</code>\u5bf9\u8c61\u5b9e\u4f8b\u4e0a\u9762\u62ff\u5230\uff0c\u5982\u679c<code>this</code>\u4e0d\u662f<code>Date</code>\u5bf9\u8c61\u5b9e\u4f8b\u5c31\u4f1a\u62a5\u9519\u3002\u8fd9\u65f6\uff0c<code>this</code>\u7ed1\u5b9a\u539f\u59cb\u5bf9\u8c61\uff0c\u5c31\u53ef\u4ee5\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-keyword">const</span> <span class="hljs-keyword">target</span> = <span class="hljs-keyword">new</span> Date(<span class="hljs-string">\'2015-01-01\'</span>);\n<span class="hljs-keyword">const</span> <span class="hljs-keyword">handler</span> = {\n  get(<span class="hljs-keyword">target</span>, prop) {\n    <span class="hljs-keyword">if</span> (prop === <span class="hljs-string">\'getDate\'</span>) {\n      <span class="hljs-keyword">return</span> <span class="hljs-keyword">target</span>.getDate.bind(<span class="hljs-keyword">target</span>);\n    }\n    <span class="hljs-function"><span class="hljs-keyword">return</span> Reflect.<span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-keyword">target</span>, prop)</span></span>;\n  }\n};\n<span class="hljs-keyword">const</span> proxy = <span class="hljs-keyword">new</span> Proxy(<span class="hljs-keyword">target</span>, <span class="hljs-keyword">handler</span>);\n\nproxy.getDate() <span class="hljs-comment">// 1</span></code></pre>\n<h2 id="\u5b9e\u4f8b\uff1aweb-\u670d\u52a1\u7684\u5ba2\u6237\u7aef">\u5b9e\u4f8b\uff1aWeb \u670d\u52a1\u7684\u5ba2\u6237\u7aef</h2>\n<p>Proxy \u5bf9\u8c61\u53ef\u4ee5\u62e6\u622a\u76ee\u6807\u5bf9\u8c61\u7684\u4efb\u610f\u5c5e\u6027\uff0c\u8fd9\u4f7f\u5f97\u5b83\u5f88\u5408\u9002\u7528\u6765\u5199 Web \u670d\u52a1\u7684\u5ba2\u6237\u7aef\u3002</p>\n<pre><code class="language-javascript">const service = create<span class="hljs-constructor">WebService(\'<span class="hljs-params">http</span>:<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-params">example</span>.<span class="hljs-params">com</span><span class="hljs-operator">/</span><span class="hljs-params">data</span>\')</span>;\n\nservice.employees<span class="hljs-literal">()</span>.<span class="hljs-keyword">then</span>(json =&gt; {\n  const employees = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">JSON</span>.</span></span>parse(json);\n  <span class="hljs-comment">// \xb7\xb7\xb7</span>\n});</code></pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u65b0\u5efa\u4e86\u4e00\u4e2a Web \u670d\u52a1\u7684\u63a5\u53e3\uff0c\u8fd9\u4e2a\u63a5\u53e3\u8fd4\u56de\u5404\u79cd\u6570\u636e\u3002Proxy \u53ef\u4ee5\u62e6\u622a\u8fd9\u4e2a\u5bf9\u8c61\u7684\u4efb\u610f\u5c5e\u6027\uff0c\u6240\u4ee5\u4e0d\u7528\u4e3a\u6bcf\u4e00\u79cd\u6570\u636e\u5199\u4e00\u4e2a\u9002\u914d\u65b9\u6cd5\uff0c\u53ea\u8981\u5199\u4e00\u4e2a Proxy \u62e6\u622a\u5c31\u53ef\u4ee5\u4e86\u3002</p>\n<pre><code class="language-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createWebService</span>(<span class="hljs-params">baseUrl</span>) </span>{\n  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>({}, {\n    <span class="hljs-keyword">get</span>(target, propKey, receiver) {\n      <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> httpGet(baseUrl+<span class="hljs-string">\'/\'</span> + propKey);\n    }\n  });\n}</code></pre>\n<p>\u540c\u7406\uff0cProxy \u4e5f\u53ef\u4ee5\u7528\u6765\u5b9e\u73b0\u6570\u636e\u5e93\u7684 ORM \u5c42\u3002</p>\n'}}]);